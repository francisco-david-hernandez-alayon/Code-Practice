<!DOCTYPE html>
<html>
<head>
    <title>Earthquake Map</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container mt-4">

<h2 class="mb-4">ğŸŒ Earthquake Map</h2>

<form method="get" class="card p-3 shadow-sm">

<div class="row g-3">

<div class="col-md-4">
    <label class="form-label">Start date</label>
    <input type="date"
           name="start_date"
           class="form-control"
           value="{{ request.query_params.get('start_date','') }}">
</div>

<div class="col-md-4">
    <label class="form-label">End date</label>
    <input type="date"
           name="end_date"
           class="form-control"
           value="{{ request.query_params.get('end_date','') }}">
</div>

<div class="col-md-4">
    <label class="form-label">Severity</label>

    <select name="severity" class="form-select">
        <option value="">All</option>

        {% set severity_selected = request.query_params.get('severity','') %}

        <option value="micro" {% if severity_selected == 'micro' %}selected{% endif %}>Micro(0, 2.4)</option>
        <option value="light" {% if severity_selected == 'light' %}selected{% endif %}>Light(2.5, 3.9)</option>
        <option value="moderate" {% if severity_selected == 'moderate' %}selected{% endif %}>Moderate(4, 5.4)</option>
        <option value="strong" {% if severity_selected == 'strong' %}selected{% endif %}>Strong(5.5, 6.9)</option>
        <option value="very_strong" {% if severity_selected == 'very_strong' %}selected{% endif %}>Very Strong(>7.0)</option>
    </select>
</div>

</div>

<!-- Plate checkbox -->
<div class="mt-3">
    <label class="form-check-label fw-bold">
        <input type="checkbox"
               name="show_plates"
               value="true"
               class="form-check-input me-2"
               {% if request.query_params.get('show_plates') == 'true' %}checked{% endif %}>
        Show tectonic plates
    </label>
</div>

<div class="d-flex flex-row align-items-start mt-3 gap-3">
    <button class="btn btn-primary">
    Search
    </button>

    <div class="d-flex align-items-center">
    <small class="text-muted">
        Note: Maximum 20,000 earthquakes can be queried.
    </small>
    </div>
</div>

</form>

<hr>

{% if error_message %}
<div class="alert alert-danger">
    Error: {{ error_message }}
</div>
{% endif %}

<div class="mb-2">
    <strong>Results found:</strong>
    {{ quake_count or 0 }} earthquakes
</div>

<div class="mb-3 text-muted">
    Searching from {{ start_date or 'yesterday' }}
    to {{ end_date or 'today' }}
</div>

<div>
    {{ map|safe }}
</div>

</body>
</html>